<!DOCTYPE html>
<html>
  <head>
    <title>Web Browser Automation</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
      font-family: 'Yanone Kaffeesatz';
      font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
  </head>
<body>
<textarea id="source">
class: center, middle

# Web Browser Automation

Chung-hong Chan a.k.a Chainsaw Riot

PhD Candidate, JMSC, HKU

---

# Web Browsers suck

![ie6](./ie6.png)

1. curl / libcurl
2. wget

---

# We can do everything with curl, right?

Bash

```bash
curl -s 'http://www.hko.gov.hk/wxinfo/currwx/current.htm' |
grep 'the Hong Kong Observatory the air temperature was'
```

Python

```python
import urllib2
import re
from bs4 import BeautifulSoup
htmlsource = urllib2.urlopen('http://www.hko.gov.hk/wxinfo/currwx/current.htm').read()
BeautifulSoup(htmlsource, "html5lib").find(name = 'div', attrs = {'style': 'display:block; width: 470px;'})
```

R

```r
readLines("http://www.hko.gov.hk/wxinfo/currwx/current.htm")
```
---

# Modern Web

* Javascript (examples: [mingpao](http://news.mingpao.com/pns/%E8%AB%87%E8%88%87%E8%8F%AF%E7%B6%B2%E7%B5%A1%E5%B0%8D%E6%94%BB%20%E5%A5%A7%E5%B7%B4%E9%A6%AC%EF%BC%9A%E4%B8%80%E5%AE%9A%E8%B4%8F%20%20%E7%BF%92%E7%89%B9%E4%BD%BF%E8%A8%AA%E7%BE%8E%E6%BB%85%E7%81%AB%20%20%E7%A8%B1%E9%81%94%E9%87%8D%E8%A6%81%E5%85%B1%E8%AD%98/web_tc/article/20150914/s00013/1442167287837) )

* Complicated login procedure (examples: [Weibo Search](http://s.weibo.com/user/&region=custom:81:1000))

---

# Web browsers are still useful

* Javascript interpreter
* Can handle HTML form, make get / post request

---

# Web browsers are designed for us to use interactively

![cat](./cat.jpg)

* Mouse / Keyboard to interact with the UI
* Display the content on the browser window and we response to it
* We are slow.

---

# non-interactive use?

![shell](./shellscript.jpg)

---

# Scripting the repetitive tasks

![geek](./geeks.png)

---

# Scripting the repetitive tasks

![geek2](./geek2.jpg)

---

# iMacros

![imacro](./Imacros.png)

* proprietary
* record macro or program a macro in Javascript

---

# Proprietary?

![huh](./shocked.gif)

---

# Selenium WebDriver

![selenium](./selenium.png)

* Selenium is a **portable software testing framework** for web applications.
* Binding to popular languages, Python and R included
* Nothing to do with Web Scraping, right?

---

# Exploit it as a general browser automation tool

![zombie](./zombie.jpg)

* **Marionetting** a browser to do whatever we want

---

# Example 1: Ming Pao

* Javascript

---

# Example 2: Captcha destroyer

* Web form interaction

---

# Example 3: Weibo search

* Javascript and web form interaction (login)
* Give Python 3 some love.

---

# Headlessly with PhantomJS

![phantom](./phantomjs2.png)

* Mingpao - headless

---

# Headlessly with Firefox

* Using xfvb - not demo today

---

# Conclusions

![winner](./winners.png)

* Selenium is a slower but more robust web request client
* No web server can resist 'real' browser requests
* Enjoy abusing it (until you hit by captchas)

---

class: center, middle

![breaking](./breaking.jpg)

**be safe, hack responsibly**

    </textarea>
    <script src="https://gnab.github.io/remark/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>
